<html>
<head>
<title>IsDirEmpty</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../lib.css" rel="stylesheet" type="text/css">
<script language="JavaScript" src="/lib/treeview/funcs.js"></script>
<script type="text/javascript" language="JavaScript"><!--
var newURL = self.location.protocol + '//' + self.location.host + '/lib/treeview/index.php?contents.php&' + RelativePath(self.location.pathname);
var ua = navigator.userAgent.toLowerCase();
if (navigator.appName == 'Microsoft Internet Explorer' && ua.indexOf('mac') > 0 && ua.indexOf('3.01') > 0) setTimeout('checkforframe()',3000);
//--></script>
</head>
<body bgcolor="#FFFFFF" onLoad="checkforframe()">
<table width="600" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td><p class="title">IsDirEmpty</p>
      <p class="boxlink">The <strong>IsDirEmpty</strong> function determines if 
        the specified directory is empty.</p>
      <table width="100" border="0" cellpadding="0" cellspacing="0" bgcolor="EAF0FF">
        <tr> 
          <td><img src="/lib/treeview/1x1.gif" width="10" height="1"></td>
          <td class="function">:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>
            :IsDirEmpty %dir%<br>
            ::<br>
            :: By: &nbsp;&nbsp;Ritchie Lawrence, 2003-09-22. Version 1.0<br>
            ::<br>
            :: Func: If specified directory is empty of files and directories, 
            then<br>
            :: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errorlevel is set to zero. 
            If directory is not empty or does not<br>
            :: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exist, errorlevel is non-zero 
            one. For NT4/2000/XP/2003.<br>
            :: <br>
            :: Args: %1 Name of directory to be tested (by val)<br>
            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>
            setlocal ENABLEEXTENSIONS &amp; dir/ad %1 &gt;nul 2&gt;nul || (endlocal 
            &amp; goto :EOF)<br>
            set i=0 &amp; for /f %%a in ('dir %1/a/b 2^&gt;nul') do set/a &quot;i+=1&quot;<br>
            md;2&gt;nul &amp; (if %i%==0 ver&gt;nul) &amp; endlocal &amp; goto 
            :EOF<br>
            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br></td>
          <td><img src="/lib/treeview/1x1.gif" width="10" height="1"></td>
      </table>
      <p class="heading">Parameters</p>
      <p><em>%1 </em>Name of directory to be tested (by val)</p>
      <p class="heading">Return Values</p>
      <p>If specified directory does not contain any files (including SYSTEM and/or 
        HIDDEN files) and the specified directory does not contain any subdirectories, 
        the errorlevel is set to zero. If the specified directory in not empty 
        or does not exist, the errorlevel is set to non-zero</p>
      <p class="heading">Example</p>
      <blockquote> 
        <p class="function">@echo off &amp; setlocal ENABLEEXTENSIONS<br>
          set var=&quot;c:\test dir&quot;<br>
          call :IsDirEmpty %var% &amp;&amp; echo/%var% is empty<br>
          goto :EOF</p>
      </blockquote>
      <p class="heading">Remarks</p>
      <p>None.</p>
      <p class="heading">See Also</p>
      <p class="boxed"><a href="GetDirStats.html">GetDirStats</a></p>
      <p class="boxed">&nbsp;</p>
      </td>
  </tr>
</table>
</body>
</html>
