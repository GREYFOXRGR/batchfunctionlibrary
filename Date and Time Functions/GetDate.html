<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>


  <title>GetDate</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

  <link href="../lib.css" rel="stylesheet" type="text/css">

  <script language="JavaScript" src="/lib/treeview/funcs.js"></script>
  <script type="text/javascript" language="JavaScript"><!--
var newURL = self.location.protocol + '//' + self.location.host + '/lib/treeview/index.php?contents.php&' + RelativePath(self.location.pathname);
var ua = navigator.userAgent.toLowerCase();
if (navigator.appName == 'Microsoft Internet Explorer' && ua.indexOf('mac') > 0 && ua.indexOf('3.01') > 0) setTimeout('checkforframe()',3000);
//--></script>
</head>

<body onload="checkforframe()" bgcolor="#ffffff">

<table border="0" cellpadding="0" cellspacing="0" width="600">

  <tbody>
    <tr>
 
    <td>
      <p class="title">GetDate</p>

      
      <p class="boxlink">The <strong>GetDate</strong> function obtains the local 
        system date.</p>

      
      <table bgcolor="#eaf0ff" border="0" cellpadding="0" cellspacing="0" width="100">

        <tbody>
          <tr>
 
          <td><img src="../../images/1x1.gif" height="1" width="10"></td>

          <td class="function">:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>

            :GetDate&nbsp;yy mm dd<br>

            ::<br>

            :: By: &nbsp;&nbsp;Ritchie Lawrence, 2002-06-15. Version 1.0<br>

            ::<br>

            :: Func: Loads local system date components into args 1 to 3.<br>

            ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For NT4/2000/XP/2003.<br>

            :: <br>

            :: Args: %1 var to receive year, 4 digits (by ref)<br>

            ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %2 var to receive month, 2 
            digits, 01 to 12 (by ref)<br>

            :: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%3 Var to receive day of month, 
            2 digits, 01 to 31 (by ref)<br>

            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>

            setlocal ENABLEEXTENSIONS<br>

            set t=2&amp;if "%date%z" LSS "A" set t=1<br>

            for /f "skip=1 tokens=2-4 delims=(-)" %%a in ('echo/^|date') 
            do (<br>
 &nbsp;&nbsp;for /f "tokens=%t%-4 delims=.-/ " %%d 
            in ('date/t') do (<br>
 &nbsp;&nbsp;&nbsp;&nbsp;set %%a=%%d&amp;set 
            %%b=%%e&amp;set %%c=%%f))<br>

            endlocal&amp;set %1=%yy%&amp;set %2=%mm%&amp;set %3=%dd%&amp;goto 
            :EOF<br>

            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</td>

          <td><img src="../../images/1x1.gif" height="1" width="10"></td>

        </tr>

      
        </tbody>
      </table>

      
      <p class="heading">Parameters</p>

      
      <p><em>%1 </em>variable to receive year, 4 digits (by ref)<br>

        <em> %2</em> variable to receive month, 2 digits, 01 to 12 (by ref)<br>

        <em> %3</em> variable to receive day of month, 2 digits, 01 to 31 (by 
        ref)</p>

      
      <p class="heading">Return Values</p>

      
      <p>See parameters above.</p>

      
      <p class="heading">Example</p>

      
      <blockquote> 
        
        <p class="function">@echo off &amp; setlocal ENABLEEXTENSIONS<br>

          call :GetDate y  m d <br>

          echo/Today is: %y%-%m%-%d%<br>

          goto :EOF</p>

      </blockquote>

      
      <p class="heading">Remarks</p>

      
      <p>This function is independant of regional settings on English
versions of Windows. For non-English versions of Windows, you will most
likely have to modify the last line of the function to reflect the
output from the DATE command. For example, in a command prompt type
DATE and press enter twice. On a typical French version of Windows the
output is:-</p>
      <p><code>La date du jour est : 31/01/2007<br>

Entrez la nouvelle date : (<span style="font-weight: bold;">jj</span>-mm-<span style="font-weight: bold;">aa</span>)</code></p>
      <p>On the second line, the "<span style="font-weight: bold;">aa</span>" represents the year and "<span style="font-weight: bold;">jj</span>" the day of the month, therefore you need to edit the last line of the function so that "yy" becomes "<span style="font-weight: bold;">aa</span>" and "dd" becomes "<span style="font-weight: bold;">jj</span>", like this:-</p>
      <p><code>
            endlocal&amp;set %1=%<span style="font-weight: bold;">aa</span>%&amp;set %2=%mm%&amp;set %3=%<span style="font-weight: bold;">jj</span>%&amp;goto 
            :EOF</code></p>
      <p>To learn more about this 
        function, see the thread from the alt.msdos.batch.nt newsgroup titled 
        "<a href="http://groups.google.com/groups?threadm=3c925925_2%40mk-nntp-1.news.uk.worldonline.com" target="_blank">Formatting 
        a date</a>".</p>

      
      <p class="heading">See Also</p>

      
      <p class="boxed"><a href="gettime.html">GetTime</a></p>

      
      <p class="boxed">&nbsp;</p>

      </td>

  </tr>

  </tbody>
</table>

<p class="boxed">&nbsp;</p>

</body>
</html>
