<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>



  
  
  <title>GetTime</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">


  
  <link href="../lib.css" rel="stylesheet" type="text/css">


  
  <script language="JavaScript" src="/lib/treeview/funcs.js"></script>
  
  <script type="text/javascript" language="JavaScript"><!--
var newURL = self.location.protocol + '//' + self.location.host + '/lib/treeview/index.php?contents.php&' + RelativePath(self.location.pathname);
var ua = navigator.userAgent.toLowerCase();
if (navigator.appName == 'Microsoft Internet Explorer' && ua.indexOf('mac') > 0 && ua.indexOf('3.01') > 0) setTimeout('checkforframe()',3000);
//--></script>
</head>


<body onload="checkforframe()" bgcolor="#ffffff">


<table border="0" cellpadding="0" cellspacing="0" width="600">


  <tbody>

    <tr>

 
    <td>
      
      <p class="title">GetTime</p>


      
      
      <p class="boxlink">The <strong>GetTime</strong> function obtains the local 
        system time.</p>


      
      
      <table bgcolor="#eaf0ff" border="0" cellpadding="0" cellspacing="0" width="100">


        <tbody>

          <tr>

 
          <td><img src="../../images/1x1.gif" height="1" width="10"></td>


          <td class="function">:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>


            :GetTime hh nn ss tt<br>


            ::<br>


            :: By: &nbsp;&nbsp;Ritchie Lawrence, updated 2007-05-12. Version 1.3<br>


            ::<br>


            :: Func: Loads local system time components into args 1 to 4.<br>


            ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For NT4/2000/XP/2003<br>


            :: <br>


            :: Args: %1 Var to receive hours, 2 digits, 00 to 23 (by ref)<br>


            ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %2 Var to receive minutes, 
            2 digits, 00 to 59 (by ref)<br>


            ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %3 Var to receive seconds, 
            2 digits, 00 to 59 (by ref)<br>


            ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %4 Var to receive centiseconds, 
            2 digits, 00 to 99 (by ref)<br>


            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>


            setlocal ENABLEEXTENSIONS<br>


            for /f "tokens=5-8 delims=:,. " %%a in ('echo/^|time') do 
            (<br>


            &nbsp;&nbsp;set hh=%%a&amp;set nn=%%b&amp;set ss=%%c&amp;set cs=%%d)<br>


            if 1%hh% LSS 20 set hh=0%hh%<br>


            endlocal&amp;set %1=%hh%&amp;set %2=%nn%&amp;set %3=%ss%&amp;set %4=%cs%&amp;goto 
            :EOF<br>


            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</td>


          <td><img src="../../images/1x1.gif" height="1" width="10"></td>


        </tr>


      
        
        </tbody>
      
      </table>


      
      
      <p class="heading">Parameters</p>


      
      
      <p><em>%1</em> Var to receive hours, 2 digits, 00 to 23 (by ref)<br>


        <em>%2</em> Var to receive minutes, 2 digits, 00 to 59 (by ref)<br>


        <em>%3</em> Var to receive seconds, 2 digits, 00 to 59 (by ref)<br>


        <em>%4</em> Var to receive centiseconds, 2 digits, 00 to 99 (by ref)</p>


      
      
      <p class="heading">Return Values</p>


      
      
      <p>See parameters above.</p>


      
      
      <p class="heading">Example</p>


      
      
      <blockquote> 
        
        
        <p class="function">@echo off &amp; setlocal ENABLEEXTENSIONS<br>


          call :GetTime h n s t<br>


          echo/Time is: %h%:%n%:%s%<br>


          goto :EOF</p>


      </blockquote>


      
      
      <p class="heading">Remarks</p>


      
      
      <p>This function is independant of regional settings on English versions of Windows.</p>

      
      <p>Update: Added a comma to the delims statement - thanks to 'Alvydas'.</p>


      
      
      <p class="heading">See Also</p>


      
      
      <p class="boxed"><a href="getdate.html">GetDate</a></p>


      </td>


  </tr>


  
  </tbody>
</table>


<p class="boxed">&nbsp;</p>


</body>
</html>
