<html>
<head>
<title>GetOS</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../lib.css" rel="stylesheet" type="text/css">
<script language="JavaScript" src="/lib/treeview/funcs.js"></script>
<script type="text/javascript" language="JavaScript"><!--
var newURL = self.location.protocol + '//' + self.location.host + '/lib/treeview/index.php?contents.php&' + RelativePath(self.location.pathname);
var ua = navigator.userAgent.toLowerCase();
if (navigator.appName == 'Microsoft Internet Explorer' && ua.indexOf('mac') > 0 && ua.indexOf('3.01') > 0) setTimeout('checkforframe()',3000);
//--></script>
</head>
<body bgcolor="#FFFFFF" onLoad="checkforframe()">
<table width="600" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td><p class="title">GetOS</p>
      <p class="boxlink">The <strong>GetOS</strong> function returns the operating 
        system version.</p>
      <table width="100" border="0" cellpadding="0" cellspacing="0" bgcolor="EAF0FF">
        <tr> 
          <td><img src="/lib/treeview/1x1.gif" width="10" height="1"></td>
          <td class="function">:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>
            :GetOS os<br>
            ::<br>
            :: By: &nbsp;&nbsp;Ritchie Lawrence, 2003-09-18. Version 1.0<br>
            ::<br>
            :: Func: Returns the O/S version; NT40, 2000, 2002 or 2003.<br>
            :: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For NT4/2000/XP/2003.<br>
            :: <br>
            :: Args: %1 var to receive O/S version (by ref)<br>
            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>
            setlocal ENABLEEXTENSIONS &amp; set &quot;cmd=net config work^|findstr/b
            /c:&quot;Soft&quot;&quot;<br>
            for /f &quot;tokens=1-2 delims=.&quot; %%a in ('%cmd%') do (<br>
&nbsp;&nbsp;for %%z in (%%a%%b) do set o=%%z)<br>
endlocal &amp; set &quot;%1=%o:40=NT40%&quot; &amp; (goto :EOF)<br>
            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</td>
          <td><img src="/lib/treeview/1x1.gif" width="10" height="1"></td>
      </table>
      <p class="heading">Parameters</p>
      <p><em>%1 </em>var to receive O/S version (by ref)</p>
      <p class="heading">Return Values</p>
      <table border="0" cellspacing="2" cellpadding="3">
        <tr> 
          <td bgcolor="#D4D8E0"><strong> Value</strong></td>
          <td bgcolor="#D4D8E0"><strong>Operating System</strong></td>
        </tr>
        <tr bgcolor="#EBEBEB"> 
          <td>NT40</td>
          <td>Microsoft Windows NT 4.0</td>
        </tr>
        <tr bgcolor="#EBEBEB"> 
          <td>2000</td>
          <td>Microsoft Windows 2000</td>
        </tr>
        <tr bgcolor="#EBEBEB"> 
          <td>2002</td>
          <td>Microsoft Windows XP</td>
        </tr>
        <tr bgcolor="#EBEBEB"> 
          <td>2003</td>
          <td>Microsoft Windows 2003</td>
        </tr>
      </table>
      <p class="heading">Example</p>
      <blockquote> 
        <p class="function">@echo off &amp; setlocal ENABLEEXTENSIONS<br>
          call :GetOS ver<br>
          echo/Operating System is: %ver%<br>
          goto :EOF</p>
      </blockquote>
      <p class="heading">Remarks</p>
      <p>This function is independant of the command interpreter version, i.e. 
        If the script is executed by a Windows 2000 version of cmd.exe on a Windows 
        NT 4.0 machine, NT40 will be returned.</p>
      <p class="heading">See Also</p>
      <p class="boxed">&nbsp;</p>
      <p class="boxed">&nbsp;</p>
      </td>
  </tr>
</table>
</body>
</html>
