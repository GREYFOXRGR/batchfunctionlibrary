<html>
<head>
<title>IsRunning</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../lib.css" rel="stylesheet" type="text/css">
<script language="JavaScript" src="/lib/treeview/funcs.js"></script>
<script type="text/javascript" language="JavaScript"><!--
var newURL = self.location.protocol + '//' + self.location.host + '/lib/treeview/index.php?contents.php&' + RelativePath(self.location.pathname);
var ua = navigator.userAgent.toLowerCase();
if (navigator.appName == 'Microsoft Internet Explorer' && ua.indexOf('mac') > 0 && ua.indexOf('3.01') > 0) setTimeout('checkforframe()',3000);
//--></script>
</head>
<body bgcolor="#FFFFFF" onLoad="checkforframe()">
<table width="600" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td><p class="title">IsRunning</p>
      <p class="boxlink">The <strong>IsRunning</strong> function determines if
        the specified service is running.</p>
      <table width="100" border="0" cellpadding="0" cellspacing="0" bgcolor="EAF0FF">
        <tr> 
          <td><img src="/lib/treeview/1x1.gif" width="10" height="1"></td>
          <td class="function">:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>
            :IsRunning %svc%<br>
            ::<br>
            :: By: &nbsp;&nbsp;Ritchie Lawrence, 2003-10-08. Version 1.0<br>
            ::<br>
            :: Func: Sets errorlevel to zero if the specified service is running,<br>
            :: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise errorlevel set to one. For NT4/2000/XP/2003.<br>
            :: <br>
            :: Args: %1 Display name of the service to check (by val)<br>
            :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br>
            setlocal ENABLEEXTENSIONS &amp; set &quot;svc=%1&quot;<br>
            set svc=%svc:&quot;=%<br>
            net start | findstr/i /b /e /c:&quot;&nbsp;&nbsp;&nbsp;%svc%&quot; &gt;nul<br>
            endlocal &amp; goto :EOF<br>
          :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</td>
          <td><img src="/lib/treeview/1x1.gif" width="10" height="1"></td>
      </table>
      <p class="heading">Parameters</p>
      <p><em>%1 </em>Display name of the service to check
        (by val)</p>
      <p class="heading">Return Values</p>
      <p>See parameters above.</p>
      <p class="heading">Example</p>
      <blockquote> 
        <p class="function">@echo off &amp; setlocal ENABLEEXTENSIONS<br>
          call :IsRunning &quot;Task Scheduler&quot; &amp;&amp; echo/Yes || echo/No<br>
        goto :EOF</p>
      </blockquote>
      <p class="heading">Remarks</p>
      <p>Note that Findstr is used with the /b and /e switches to avoid false
        positives. This could happen when checking  if &quot;Server&quot;
        service is running and there are other services containing the word &quot;server&quot;.
        Also note there are three spaces between <span class="function">/c:&quot;</span> and <span class="function">%svc%&quot;</span>.</p>
      <p>Bear in mind that a paused service is still regarded as running by the
        <span class="function">net</span> command. If it's important to know
        whether the service is running <em>and</em> not paused, then a third party utility
        will be required for Windows NT4 and 2000. Windows XP and 2003 can use
        the built-in SC.exe tool.</p>
      <p class="heading">See Also</p>
      <p class="boxed">None</p>
      <p class="boxed">&nbsp;</p>
    </td>
  </tr>
</table>
</body>
</html>
